\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{natbib}
\usepackage{graphicx}
\usepackage{tikz-cd}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{yfonts}
\usepackage{hyperref}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{geometry}
\usepackage{tikz-cd}

\geometry{
 a4paper,
 total={170mm,257mm},
 left=35mm,
 right=35mm,
 top=20mm,
 }

\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
}

\urlstyle{same}
%\newcommand{\goth}[1]{\text{\textgoth{#1}}

\title{Exact Sequences and Fractions \\ Remark after Corollary 3.13}
\author{Rafal Michalski}
\date{}

\newtheorem{theorem}{Fact}
\newtheorem{example}[theorem]{Example}

\begin{document} 

\maketitle

An exact sequence

\[
0 \longrightarrow M' \overset{f}{\longrightarrow} M \overset{g}{\longrightarrow} M' \longrightarrow 0
\]

\noindent
induces isomorphism $M/f(M') \cong M''$ . It works like this:
\[
m + f(M') \mapsto g(m)
\]

\noindent
The case of a quotient
+
\[
0 \longrightarrow N \overset{\iota}{\longrightarrow} M \overset{\pi}{\longrightarrow} M/N \longrightarrow 0
\]
\[
m + N \mapsto m + N
\]
\noindent
as $\iota(N) = N$ here, then $M / \iota(N) = M/N$ .

\vspace{2mm}

Apply the exact functor $S^{-1}$ now:

\[
0  \longrightarrow S^{-1}N {\xrightarrow{\hspace{2mm}S^{-1}\iota\hspace{2mm}}} S^{-1}M {\xrightarrow{\hspace{2mm}S^{-1}\pi\hspace{2mm}}} M/N \longrightarrow 0
\]

\noindent
where $S^{-1}\iota$ is

\[
y/s \mapsto  y/s
\]

\noindent
the left in $S^{-1}N$, the right in $S^{-1}M$, and $S^{-1}\pi$ is

\[
x/s \mapsto \pi(x)/s 
\]

\[
x/s \mapsto \frac{x + N}{s}
\]

As sets, $N \times S \subseteq M \times S$. And $S^{-1}\iota$ is an injection. Is it an embedding? Is a class in $N \times S$ also a class in $M \times S$ ? Any class in $N \times S$ is contained in some class in $M \times S$: if $(y, s) \sim (y', s')$ in $N \times S$, then $u(s'y - sy')$ for some $u \in S$, which is also true in $M \times S$ so the pairs are also related in this larger product. The map $S^{-1}\iota: y/s \mapsto y/s$ assigns to a class in the smaller the containing class in the larger. Can the larger class contain more smaller classes? This would contradict the injectivity of the map, so it cannot. Can the larger class be a strictly larger set? Yes, two cases may happen. First, $(y, s) \sim (x, s')$ for some $x \notin N$, second, $(x, s') \sim (x', s'')$ for some another $x' \notin N$ . The map $S^{-1}\iota$ is an injection, but not an embedding.

The co-kernel isomorphism $S^{-1}M/S^{-1}\iota(S^{-1}N) \rightarrow S^{-1}(M/N)$ is

\[
\frac{S^{-1}M}{S^{-1}\iota(S^{-1}N)} \cong S^{-1}(M/N)
\]

\[
\frac{x}{s} + S^{-1}\iota(S^{-1}N) \mapsto S^{-1}\pi(\frac{x}{s})
\]

\[
\frac{x}{s} + S^{-1}\iota(S^{-1}N) \mapsto \frac{x + N}{s}
\]

If we decide to identify $S^{-1}\iota(S^{-1}N)$ with $S^{-1}N$, since both are $\{ y/s: y \in N \}$, although in the image the fraction is in $S^{-1}M$ not $S^{-1}N$, we can write the cokernel isomorphism as

\[
\frac{x}{s} + S^{-1}N \mapsto \frac{x + N}{s}
\]

Way 1: localizing at $\textgoth{p}$ then taking the quotient $\mod \textgoth{q}$ . But $\textgoth{q}$ is not an ideal of $A_\textgoth{p}$, only an ideal of $A$. By Corollary 3.13, ideals of $A_\textgoth{p}$ are in 1-1 correspondence with the prime ideals of $A$ contained in $\textgoth{p}$

\[
\textgoth{q} \mapsto S^{-1}\textgoth{q} = \{a/s: a \in \textgoth{q}, s \notin \textgoth{p}\}
\]

\noindent
As $S^{-1}\textgoth{q}$ is an ideal in $A_\textgoth{p}$, we can take the quotient $A_\textgoth{p} / S^{-1}\textgoth{q}$ . Its elements look like 

\[
\frac{a}{s} + S^{-1}\textgoth{q}, a \in \textgoth{q}, s \notin \textgoth{p}
\]

Way 2: taking the quotient by $\textgoth{q}$ then localizing in the image of $\textgoth{p}$ which is $\{ a + \textgoth{q}: a \in \textgoth{p} \}$ that we can write ambiguously as $\textgoth{p} + \textgoth{q}$. The localization now has symbol $(A/\textgoth{q})_{\textgoth{p} + \textgoth{q}}$. The general element of the localization is 

\[
\frac{a + \textgoth{q}}{s + \textgoth{q}}, \; s + \textgoth{q} \notin \textgoth{p} + \textgoth{q}
\]

\begin{theorem}
$s + \textgoth{q} \notin \textgoth{p} + \textgoth{q} \iff s \notin \textgoth{p}$ .
\end{theorem}

\noindent 
\textit{Proof}. The $\implies$ direction: Let $s + \textgoth{q} \in \textgoth{p} + \textgoth{q}$; $s + \textgoth{q} = a + \textgoth{q}$ for some $a \in \textgoth{p}$; $s - a \in \textgoth{q}$, but since $\textgoth{q} \subseteq \textgoth{p}$, $s - a \in \textgoth{p}$; now $s \in \textgoth{p}$. The $\impliedby$ direction is obvious.

The general element of the localization $(A/\textgoth{q})_{\textgoth{p} + \textgoth{q}}$ is now

\[
\frac{a + \textgoth{q}}{s + \textgoth{q}}, \; s + \textgoth{q} \notin \textgoth{p} + \textgoth{q}
\]

\[
  \begin{tikzcd}
     A \arrow[r, "\phi"] \arrow[d, two heads] & A_\textgoth{p} \arrow[dd, , two heads] \\
     A/\textgoth{q} \arrow[d] \\
     (A/\textgoth{q})_{\textgoth{p} + \textgoth{q}} \arrow[r, "\cong"] & A_\textgoth{p}/\textgoth{q}_\textgoth{p} 
  \end{tikzcd}
\]

\noindent
Where $\textgoth{q}_\textgoth{p} = S^{-1}\textgoth{q}$ with $S = A - \textgoth{p}$. Is this notation used anywhere?

By (3.4.iii), the bottom arrow should be an isomorphism. 
\begin{enumerate}
    \item Map between sets: $\frac{a + \textgoth{q}}{s} \mapsto \frac{a + \textgoth{q}}{s + \textgoth{q}}$  .
    \item Show this is an $A$-module isomorphism.
    \item Show that $(A/\textgoth{q})_{\textgoth{p}+\textgoth{q}}$ is an $A_\textgoth{p}$-module, as $A_\textgoth{p}/\textgoth{q}_\textgoth{p}$ already is. This step is probably optional as we target a ring isomorphism.
    \item Prove our map being a ring isomorphism. So why did we need $A_\textgoth{p}$-modules? Why even $A$-modules? For commutative group maybe.
\end{enumerate}

The map
\[
(A/\textgoth{q})_{\textgoth{p}+\textgoth{q}} \ni 
\frac{a + \textgoth{q}}{s} \mapsto \frac{a + \textgoth{q}}{s + \textgoth{q}} \in
A_\textgoth{p}/\textgoth{q}_\textgoth{p}
\]

Well-definition. Let
\[
\frac{a + \textgoth{q}}{s} = \frac{a' + \textgoth{q}}{s'} 
\]
\[
u(s'(a + \textgoth{q}) - s(a' + \textgoth{q}) = 0
\]
\[
us'a - usa' \in \textgoth{q}
\]
\[
u(s'a - sa') \in \textgoth{q}
\]
\noindent
but $u \notin \textgoth{p}$ then $u \notin \textgoth{p}$ then $s'a - sa' \in \textgoth{q}$. Now when
\[
\frac{a + \textgoth{q}}{s + \textgoth{q}} = \frac{a' + \textgoth{q}}{s' + \textgoth{q}}
\]
in the ring $(A/\textgoth{q})_{\textgoth{p}+\textgoth{q}}$ ? 
The multipliset is $A/\textgoth{q}-(\textgoth{p}+\textgoth{q})$.
\[
(u + \textgoth{q}((s' + \textgoth{q})(a + \textgoth{q}) - (s + \textgoth{q})(a' + \textgoth{q})) = 0 + \textgoth{q}
\]
\noindent
for some $u + \textgoth{q} \notin \textgoth{p} + \textgoth{q} \iff u \notin \textgoth{p}$.
\[
u(s'a - sa') \in \textgoth{q}
\]
\noindent
but $u \notin \textgoth{q}$
\[
s'a - sa' \in \textgoth{q}
\]
\noindent
We have got the same condition as above, so our map is well defined.

Our map looks surjective. Is it injective? Let
\[
\frac{a + \textgoth{q}}{s + \textgoth{q}} = \frac{a' + \textgoth{q}}{s' + \textgoth{q}}
\]
\noindent
We already know the condition for this:
\[
s'a - sa' \in \textgoth{q} \implies \frac{a + \textgoth{q}}{s} = \frac{a' + \textgoth{q}}{s}
\]
\noindent
The map is finally bijective. 

It remains to verify the preservation of multiplication
\[
\frac{a + \textgoth{q}}{s} \cdot \frac{a' + \textgoth{q}}{s'} 
= \frac{aa' + \textgoth{q}}{ss'} \mapsto 
\frac{aa' + \textgoth{q}}{ss' + \textgoth{q}} 
= \frac{a + \textgoth{q}}{s + \textgoth{q}} \cdot \frac{a' + \textgoth{q}}{s' + \textgoth{q}}
\]
\noindent
the image of multiplication is the multiplication of images, thus the multiplication is preserved.

Let's consider the localized ring $(A/\textgoth{q})_{\textgoth{p} + \textgoth{q}}$ as an $A_\textgoth{p}$-module. The scalar multiplication will be
\[
\frac{a}{s} \cdot \frac{a' + \textgoth{q}}{s' + \textgoth{q}} = 
\frac{aa' + \textgoth{q}}{ss' + \textgoth{q}}
\]
\noindent
Well-definition? Let 
\[
\frac{a_1}{s_1} = \frac{a_2}{s_2} \quad \text{and} \quad
\frac{a'_1 + \textgoth{q}}{s'_1 + \textgoth{q}} = \frac{a'_2 + \textgoth{q}}{s'_2 + \textgoth{q}}
\]
\[
u(a_1s_2 - a_2s_1) = 0, u \notin \textgoth{p}; \quad s'_2a'_1-s'_1a'_2 \in \textgoth{q}
\]
\[
a_1s_2 - a_2s_1 = 0
\]
\noindent
Now the condition for
\[
\frac{a_1a'_1 + \textgoth{q}}{s_1s'_1 + \textgoth{q}} = \frac{a_2a'_2 + \textgoth{q}}{s_2s'_2 + \textgoth{q}}
\]
\noindent
is
\[
s_2s'_2a_1a'_1 - s_1s'_1a_2a'_2 \in \textgoth{q}
\]
\noindent
Let
\[
c = a_1s_2 - a_2s_1
\]
\[
c(s'_2a'_1 - s'_1a'_2) \in \textgoth{q}
\]
\noindent
because the parentheses are in $\textgoth{q}$. The scalar multiplication is well-defined, because this condition is satisfied.
y
\vspace{2mm}
Way 1 with $\textgoth{p} = \textgoth{q}$.
\noindent
Localize at \textgoth{p}, the n take the quotient by the ideal in 1-1 correspondence with \textgoth{p} which id $S^{-1}\textgoth{p}$ that we also write as $\textgoth{p}_\textgoth{p}$. Mow $A_\textgoth{p}$ is a local ring with the single maximal ideal $\textgoth{p}_\textgoth{p}$ (Example 1 after Corollary 3.2). Taking quotient gives us a field - see remark on p. 37.

\vspace{2mm}
Way 2 with $\textgoth{p} = \textgoth{q}$.
Take the quotient by $\textgoth{p}$, then localize in the image of $\textgoth{p}$ which is the zero ideal. The multiplicative set is all but zero in $A/\textgoth{p}$, we get the field of fractions of the integral domain $A/\textgoth{p}$.

The map between the ways' ends is

\[
(A/\textgoth{p})_{0+\textgoth{p}} \ni \frac{a + \textgoth{p}}{s} 
\mapsto
\frac{a + \textgoth{p}}{s + \textgoth{p}} \in A_\textgoth{p}/\textgoth{p}_\textgoth{p} 
\]

\end{document}S
