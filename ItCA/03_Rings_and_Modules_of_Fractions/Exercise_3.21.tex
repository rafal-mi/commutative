\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{natbib}
\usepackage{graphicx}
\usepackage{tikz-cd}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{yfonts}
\usepackage{hyperref}
\usepackage{amsthm}
\usepackage{stmaryrd}
\usepackage{mathtools}


\usepackage{geometry}
\geometry{
 a4paper,
 total={170mm,257mm},
 left=35mm,
 right=35mm,
 top=20mm,
 }

\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
}

\newcommand{\mf}{\mathfrak}
\newcommand{\aaa}{\mf a}
\newcommand{\bbb}{\mf b}
\newcommand{\ppp}{\mf p}
\newcommand{\qqq}{\mf q}
\newcommand{\Spec}{\operatorname{Spec}}

\urlstyle{same}
%\newcommand{\goth}[1]{\text{\textgoth{#1}}

\newtheorem{theorem}{Theorem}

\title{Exercise 3.21}


\begin{document}

\maketitle

\begin{center}
M.F. Atiyah, I.G. MacDonald \emph{Introduction to Commutative Algebra}
\end{center}

\vspace*{10px}

\textbf{Exercise 3.21.i}. 
Show that $\phi^*: \text{Spec}(S^{-1}A) \rightarrow \text{Spec}(A)$ is a homeomorphism of $\text{Spec}(S^{-1}A)$ onto its image in $X = \text{Spec}(A)$.

\vspace*{10px} 

\noindent
We want to prove that for $D$ closed in $\text{Spec}(S^{-1}A)$ there is $C$ closed in $\text{Spec}(A)$ and reverse, that the equation holds
\[
C \cup \phi^*(\text{Spec}(S^{-1}A)) = \phi^*(D)
\]
We take
\[
C = V(\textgoth{a}), \quad D = V(S^{-1}\textgoth{a})
\]
That is, we are going to prove that
\[
V(\textgoth{a}) \cap \phi^*(\text{Spec}(S^{-1}\textgoth{a}))= \phi^*(V(S^{-1}\textgoth{a}))
\]
Recalling that $S^{-1}\textgoth{p} \xmapsto{\phi^*} \textgoth{p}$, the right are all prime ideals not meeting $S$ and holding $S^{-1}\textgoth{p} \supseteq S^{-1}\textgoth{a}$. By the fact that this happens iff $\textgoth{p} \supseteq \textgoth{a}$, they are all prime ideals not meeting $S$ and containing \textgoth{a}. Which is precisely the left.

\noindent
Now $\phi^*$ maps closed files to closed files in any direction.
\qed

\vspace*{22px}

\textbf{Exercise 3.21.ii}. 
Let $f: A \rightarrow B$ be a ring homomorphism...

\vspace*{10px} 

\begin{tikzcd}
X \arrow[r, equal]
& \textrm{Spec}(A) 
  & \textrm{Spec}(B) \arrow[l, "f^*"'] \arrow[r, equal] 
  & Y \\
S^{-1}X \arrow[r, equal]
  & \phi^*(\textrm{Spec}(S^{-1}A)) \arrow[u, hook] 
  & \psi^*(\textrm{Spec}(f(S)^{-1}B)) \arrow[u, hook] 
  & S^{-1}Y \arrow[l, equal] \\
  & \textrm{Spec}(S^{-1}A) \arrow[u, leftrightarrow] 
  & \textrm{Spec}(f(S)^{-1}B) \arrow[u, leftrightarrow] \arrow[l, "S^{-1}f^*"']
\end{tikzcd}

\begin{tikzcd}
\textgoth{p} 
  & \textgoth{q} \arrow[l, "f^*"', mapsto] \\
\textgoth{p} \arrow[u, equal] 
  & \textgoth{q} \arrow[u, equal] \\
S^{-1}\textgoth{p} \arrow[u, leftrightarrow] 
  & f(S)^{-1}\textgoth{q} \arrow[u, leftrightarrow] \arrow[l, "S^{-1}f^*"', mapsto] \\
\end{tikzcd}

\noindent
That $(S^{-1}f)^* : \textrm{Spec}(S^{-1}B) \rightarrow \textrm{Spec}(S^{-1}A)$ is the restriction of $f^*$ to $S^{-1}Y$ we have already proved in Facts, showing the action of $(S^{-1}f)^*$:
\[
    (S^{-1}f)^*: S^{-1}\textgoth{q} \mapsto S^{-1}\textgoth{p}
\]

\noindent
What is $S^{-1}X = \phi^*(\textrm{Spec}(S^{-1}A))$? All prime ideals of $A$ not meeting $S$. \\ 
What is $f^{*-1}(S^{-1}X) = f^{*-1}(\phi^*(\textrm{Spec}(S^{-1}A)))$? All prime ideals of $B$ whose preimages in $A$ do not meet $S$. \\
What is $S^{-1}Y = \psi^*(\textrm{Spec}(S^{-1}B))$? All prime ideals of $B$ not meeting $f(S)$. \\ 
We show that the the last two sets are equal.\\
$\supseteq$: If \textgoth{q} does not meet $f(S)$, may its preimage $f^{-1}(\textgoth{q})$ meet $S$? Let $s \in f^{-1}(\textgoth{q})$; $f(s) \in \textgoth{q}$; now $\textgoth{q}$ meets $f(S)$, a contradiction. So it cannot. \\
$\subseteq$: Let's not let the preimage $f^{-1}(\textgoth{q})$ of a prime ideal $\textgoth{q}$ of
$B$ meet $S$. May $\textgoth{q}$ meet $f(B)$? $f(s) \in \textgoth{q}$; $s\in f^{-1}(\textgoth{q}$; now the preimage $f^{-1}(\textgoth{q})$ in $A$ meets $S$, a contradiction. So it cannot. 


\vspace*{22px}

\textbf{Exercise 3.21.iii}. 
Let $\textgoth{a}$ be an ideal of $A$ and let $\textgoth{b} = \textgoth{a}^e$ be its extension in $B$...

\vspace*{10px} 

Let \textgoth{a} be an ideal of $A$ and let $\textgoth{b} = \textgoth{a}^e$ be its extension in $B$. What is the homomorphism?
\[
  \tilde{f}: A/\textgoth{a} \rightarrow B/\textgoth{b} 
\]

\noindent
Recall what does a homomorphism need to factor through a quotient?

\begin{tikzcd}
  A \arrow[rr, "\phi"] \arrow[rd, "\pi"] & & B \arrow[ld, "\tilde{\phi}"] \\
  & A/\textgoth{q} \\
\end{tikzcd}

\noindent
The map $\tilde{\phi}$ has to be defined on representatives and cannot differ between them.
\[
  \tilde{\phi}(a + \textgoth{a}) = \tilde{\phi}(a' + \textgoth{a})
\]
if $a + \textgoth{a} = a' + \textgoth{a}$ iff $a - a' \in \textgoth{a}$. \\
We define $\tilde{\phi}$ by $\tilde{\phi}(a + \textgoth{a}) = \phi(a)$ so it has to be
\[
  \phi(a) = \phi(a') \;\; \text{if} \;\; a - a' \in \textgoth{a} 
\]
\[
  \phi(a - a') = 0 \;\; \text{if} \;\; a - a' \in \textgoth{a}
\]
\[
  \phi(a) = 0 \;\; \text{if} \;\; a \in \textgoth{a}
\]
\[
  \textrm{ker} \; \phi \supseteq \textgoth{a}
\]

\noindent
To factor through the quotient by an ideal, the homomorphism's kernel must contain this ideal. \\
A homomorphism factors through any ideal contained in its kernel.

If $\textgoth{a} \subseteq \phi^{-1}(0)$ then $\phi(a) = 0$ for $a \in \textgoth{a}$ then $\phi(a - a') = 0$ for $a - a' \in \textgoth{a}$ then $\phi(a) = \phi(a')$ for $a + \textgoth{a} = a' + \textgoth{a}$ and we can say $\tilde{\phi}(a + \textgoth{a}) = \phi(a)$.

We return to $f: A \rightarrow B$, $\textgoth{a} = f^{-1}(\textgoth{b})$, $\textgoth{b}$ an ideal of $B$.
\[
  A \xrightarrow{f} B \xrightarrow{\rho} B/\textgoth{b}
\]

\noindent

Does the kernel contain $\textgoth{a}$? If $a \in \textgoth{a}$ then $a \mapsto f(a) \mapsto f(a) + \textgoth{b}$, but $f(a) \in \textgoth{b}$ so $a$ maps to zero and is in the kernel of this composition homomorphism, which then factors through the quotient:

\begin{tikzcd}
  A \arrow[r, "f"] \arrow[rd, two heads] & B \arrow[r, "\rho", two heads] & B / \textgoth{b} \\
  & A / \textgoth{a} \arrow[ru] &
\end{tikzcd}

\begin{tikzcd}
  a \arrow[r, "f", mapsto] \arrow[rd, mapsto] & f(a) \arrow[r, "\rho", mapsto] & f(a) + \textgoth{b} \\
  & a + \textgoth{a} \arrow[ru, mapsto] &
\end{tikzcd}

How does $\textrm{Spec}(A/\textgoth{a})$ have it canonical image $V(\textgoth{a})$ in $\textrm{Spec}(A)$ ?

\[
  A \xrightarrow{\pi} A/\textgoth{a}
\]
\[
  a \mapsto a + \textgoth{a}
\]

\noindent
That there is a 1-1 correspondence between ideals of $A/\textgoth{a}$ and ideals of $A$ containing $\textgoth{a}$, we are told in the text on page 9. And that prime ideals correspond to prime ideals. So we have a bijection between $\textrm{Spec(A/\textgoth{a})}$ and prime ideals of $A$ containing $\textgoth{a}$, which comprise the set $V(\textgoth{a})$. We are not required to prove a homeomorphism here.

\begin{tikzcd}[column sep=large]
  A \arrow[r, "f"] \arrow[d, "\pi", two heads] 
    & B \arrow[d, "\rho", two heads] \\
  A/\textgoth{a} \arrow[r, "\tilde{f}"] & B/\textgoth{b}
\end{tikzcd}
\quad
\begin{tikzcd}[column sep=large]
  \textrm{Spec}(A) 
    & \textrm{Spec}(B) \arrow[l, "f^*"'] \\
  \pi^*(\textrm{Spec}(A/\textgoth{a})) \arrow[u, hook] 
    & \rho^*(\textrm{Spec}(B/\textgoth{b})) \arrow[l] \arrow[u, hook] \\
  \textrm{Spec}(A/\textgoth{a}) \arrow[u, leftrightarrow] \arrow[uu, "\pi^*", bend left=75]
    & \textrm{Spec}(B/\textgoth{b}) \arrow[l, "\tilde{f}^*"'] , \arrow[u, leftrightarrow] \arrow[uu, "\rho^*"', bend right=75]
\end{tikzcd}

\noindent
The general prime ideal of $B/\textgoth{b}$ is $\rho(\textgoth{q})$ where $\textgoth{q}$ is a prime ideal of $B$ containing $\textgoth{b}$. 
\[
  \tilde{f}^*: \rho(\textgoth{q}) \mapsto \tilde{f}^{-1}(\rho(\textgoth{q}))
\]
\[
  \tilde{f}^{-1}(\rho(\textgoth{q})) = \{ a + \textgoth{a}: f(a) + \textgoth{b} \in \rho(\textgoth{q}) \} = \dots
\]

\vspace*{10px}

\textbf{Property}. $b + \textgoth{b} \in \rho(\textgoth{q}) \iff b\in \textgoth{q}$. \\

Probably general for surjective homomorphism and an ideal, or even a set, containing the kernel. \\
\noindent
If $b + \textgoth{b} \in \rho(\textgoth{q})$ then $b + \textgoth{b} = b' + \textgoth{b}$ for some $b' \in \textgoth{q}$, then $b - b' \in \textgoth{q}$ and $b' \in \textgoth{q}$, then $b \in \textgoth{q}$. \\ 
If $b \in \textgoth{q}$ then $\rho(b) \in \rho(\textgoth{q})$, meaning $b + \textgoth{b} \in \textgoth{q}$. \qed 

\begin{equation*}
\begin{split}
  \dots & = \{ a + \textgoth{a}: f(a) \in \textgoth{q} \} \\
        & = f^{-1}(\textgoth{q}) + \textgoth{a} \\ 
        & = \pi(f^{-1}(\textgoth{q}))
\end{split}
\end{equation*}

\noindent
Now $\pi^*$ maps this to $\pi^{-1}(\pi(f^{-1}(\textgoth{q})))$. As $\pi$ is surjective, this set is $f^{-1}(\textgoth{q}) = f^*(\textgoth{q})$. \\
The up-left path: $\rho(\textgoth{q})$ is identified in $\text{Spec}(B)$ with $\textgoth{q}$ then this is mapped by $f^*$ to $f^{-1}(\textgoth{q}) = f^*(\textgoth{q})$. 

\begin{tikzcd}
\textgoth{p} 
  & \textgoth{q} \arrow[l, "f^*"', mapsto] \\
\textgoth{p} \arrow[u, equal] 0
  & \textgoth{q} \arrow[u, equal] \\
\textgoth{p} + \textgoth{a} \arrow[u, leftrightarrow] 
  & \textgoth{q} + \textgoth{b} \arrow[u, leftrightarrow] \arrow[l, "\tilde{f}^*"', mapsto] \\
\end{tikzcd}

\noindent
We took the risk to write $\pi(\textgoth{p})$ as $\textgoth{p} + \textgoth{a}$ and $\rho(\textgoth{q})$ as $\textgoth{q} + \textgoth{b}$.

\vspace*{22px}

\textbf{Exercise 3.21.iv}. 
Let $\textgoth{p}$ be a prime ideal of $A$...

\noindent
We take $S = A \setminus \textgoth{p}$ in (ii)

\begin{tikzcd}[column sep=large]
  \textrm{Spec}(A) 
    & \textrm{Spec}(B) \arrow[l, "f^*"'] \\
  \phi^*(\textrm{Spec}(A_\textgoth{p}) \arrow[u, hook] 
    & \psi^*(\textrm{Spec}(B_\textgoth{p})) \arrow[l] \arrow[u, hook] \\
  \textrm{Spec}(A_\textgoth{p}) \arrow[u, leftrightarrow] \arrow[uu, "\phi^*", bend left=75]
    & \textrm{Spec}(B_\textgoth{p
    }) \arrow[l, "f_\textgoth{p}^*"'] \arrow[u, leftrightarrow] \arrow[uu, "\psi^*"', bend right=75]
\end{tikzcd}
\begin{tikzcd}
\textgoth{p} 
  & \textgoth{q} \arrow[l, "f^*"', mapsto] \\
\textgoth{p} \arrow[u, equal] 
  & \textgoth{q} \arrow[u, equal] \\
S^{-1}\textgoth{p} \arrow[u, leftrightarrow] 
  & S^{-1}\textgoth{q} \arrow[u, leftrightarrow] \arrow[l, "S^{-1}f^*"', mapsto] \\
\end{tikzcd}

What a ring can be reduced modulo $S^{-1}\textgoth{p} = (A \setminus \textgoth{p}) \textgoth{p} = \textgoth{p}A_\textgoth{p}$? Only a ring of which $S^{-1}\textgoth{p}$ is an ideal, that is, the ring $A_\textgoth{p}$.
In (iii), the ring $B$ to the right is reduced by the extension of the ideal $\textgoth{a}$ of $A$. What is the extension of the ideal $\textgoth{p}A_\textgoth{p}$ in $B$? We know from Fact that this is $\textgoth{p}B_\textgoth{p}$.

This is how we apply (iii): $A := A_\textgoth{p}$, $\textgoth{a} := \textgoth{p}A_\textgoth{p}$, $\textgoth{b} := \textgoth{p}B_\textgoth{p}$, $f := f_\textgoth{p} := S^{-1}f: A_\textgoth{p} \rightarrow B_\textgoth{p}$.

\begin{tikzcd}[column sep=large]
  \textrm{Spec}(A) 
    & \textrm{Spec}(B) \arrow[l, "f^*"'] \\
  \phi^*(\textrm{Spec}(A_\textgoth{p})) \arrow[u, hook] 
    & \psi^*(\textrm{Spec}(B_\textgoth{p})) \arrow[l] \arrow[u, hook] \\
  \textrm{Spec}(A_\textgoth{p}) \arrow[u, leftrightarrow] \arrow[uu, "\phi^*", bend left=75]
    & \textrm{Spec}(B_\textgoth{p
    }) \arrow[l, "f_\textgoth{p}^*"'] \arrow[u, leftrightarrow] \arrow[uu, "\psi^*"', bend right=75] \\
  \pi^*(\textrm{Spec}\left(\dfrac{A_\textgoth{p}}{\textgoth{p} A_\textgoth{p}}\right)) \arrow[u, hook] 
    & \rho^*(\textrm{Spec}\left(\dfrac{B_\textgoth{p
    }}{\textgoth{p}B_\textgoth{p}}\right)) \arrow[l] \arrow[u, hook] \\
  \textrm{Spec}\left(\dfrac{A_\textgoth{p}}{\textgoth{p} A_\textgoth{p}}\right) \arrow[u, leftrightarrow] \arrow[uu, "\pi^*", bend left=75]
    & \textrm{Spec}\left(\dfrac{B_\textgoth{p
    }}{\textgoth{p}B_\textgoth{p}}\right) \arrow[l, "\tilde{f}_\textgoth{p}^*"'] \arrow[u, leftrightarrow] \arrow[uu, "\rho^*"', bend right=75]
\end{tikzcd}

\begin{tikzcd}[column sep=large]
\textgoth{p} 
  & \textgoth{q} \arrow[l, "f^*"', mapsto] \\
\textgoth{p} \arrow[u, equal] 
  & \textgoth{q} \arrow[u, equal] \\
S^{-1}\textgoth{p} \arrow[u, leftrightarrow] \arrow[d, equal]
  & f(S)^{-1}\textgoth{q} \arrow[u, leftrightarrow] \arrow[l, "S^{-1}f^*"', mapsto] \arrow[d, equal] \\
f^{-1}(\textgoth{q})A_\textgoth{p} 
  & \textgoth{q}B_\textgoth{p} \arrow[l, "f_\textgoth{p}^*"', mapsto] \\
f^{-1}(\textgoth{q})A_\textgoth{p} \arrow[u, equal] 
  & \textgoth{q}B_\textgoth{p} \arrow[l, mapsto] \arrow[u, equal] \\
f^{-1}(\textgoth{q})A_\textgoth{p} + \textgoth{p}A_\textgoth{p} \arrow[u, leftrightarrow] 
  & \textgoth{q}B_\textgoth{p} + \textgoth{p}B_\textgoth{p} \arrow[l, "\tilde{f}_\textgoth{p}^*"', mapsto] \arrow[u, leftrightarrow] 
\end{tikzcd}

\vspace{2mm}

What is $f^{*-1}(\textgoth{p})$? It is the set $\{ \textgoth{q}: f^*(\textgoth{q}) = \textgoth{p}\} = \{ \textgoth{q}: \textgoth{p} = f^{-1}(\textgoth{q})\}$. We know that $f^{*-1}(S^{-1}X) = S^{-1}Y$ and $\textgoth{p} \in S^{-1}X$ so $f^{*-1}(\textgoth{p}) \subseteq S^{-1}Y$. Any ideal $\textgoth{q} \in f^{*-1}(\textgoth{p})$ does not meet $f(A \setminus \textgoth{p})$: $a \in A \setminus \textgoth{p}$; $f(a) \in \textgoth{q}$; $a \in f^{-1}(\textgoth{q})$; $a \in \textgoth{p}$, a contradiction. So it is in $\psi^*(\textrm{Spec}(B_\textgoth{p}))$. To fall into $\rho^*(\textrm{Spec}(B_\textgoth{p}/\textgoth{p}B_\textgoth{p}))$, $\textgoth{q}B_\textgoth{p}$ should contain $\textgoth{p}B_\textgoth{p}$.
\[
\textgoth{p}B_\textgoth{p} = \Big\{\frac{f(a)}{s}: a \in \textgoth{p}, b \in B, s \notin \textgoth{p} \Big\}
\]
\[
\textgoth{q}B_\textgoth{p} = \Big\{\frac{b}{s}: b \in \textgoth{q}, s \notin \textgoth{p} \Big\}
\]
But $f(a) \in \textgoth{q}$, then $f(a)b \in \textgoth{q}$. So $\textgoth{q}B_\textgoth{p} \supseteq \textgoth{p}B_\textgoth{p}$. We have shown that
\[
f^{*-1}(\textgoth{p}) \subseteq \psi^*(\rho^*(B_\textgoth{p}/\textgoth{p}B_\textgoth{p}))
\]
The reverse inclusion is obvious from both diagrams combined (the large diagram). Also the diagram shows  a bijection.

A closed set in $\textrm{Spec}(B_\textgoth{p}/\textgoth{p}B_\textgoth{p})$ is $V(\rho(\textgoth{b}B_\textgoth{p})) = \rho(V(\textgoth{b}B_\textgoth{p}))$. We want to show that the $\psi^* \circ \rho^*$ image of this set is a closed set in $\textrm{Spec}(B)$ i.e. the set of prime ideals containing some ideal of $B$, intersected with $f^{*-1}(\textgoth{p})$.

Note that all arrows of the combined diagram work on prime, not ordinary ideals.

Our contained ideal is the surjection of some ideal $\textgoth{b}B_\textgoth{p}$ and the same is true for containing prime ideals, they are surjections of prime ideals of $B_\textgoth{p}$ containing $\textgoth{b}B_\textgoth{p}$.

Now there is a fact: $\textgoth{b} \subseteq \textgoth{q} \iff \textgoth{b}B_\textgoth{p} \subseteq \textgoth{q}B_\textgoth{p}$: $\textgoth{b} \subseteq \textgoth{b}^{ec} \subseteq \textgoth{q}^{ec} = \textgoth{q}$. 

The inclusion relations have moved from $\textrm{Spec}(B_\textgoth{p}/\textgoth{p}B_\textgoth{p})$ to $\textrm{Spec}(B)$ through $\psi^* \circ \rho^*$: 
\[
(\psi^* \circ \rho^*) (V(\textgoth{b}B\textgoth{p} + \textgoth{p}B_\textgoth{p})) 
= \psi^*(V(\textgoth{b}B_\textgoth{p}))
= V(\textgoth{b)}
\]
a closed set in $\textrm{Spec}(B)$. This set happens to be contained in $f^{*-1}(\textgoth{p})$ due to the bijection proven above.

Now take a closed set in $f^{*-1}(\textgoth{p})$. It is the intersection of a closed set in $\textrm{Spec}(B)$ with the set $f^{*-1}(\textgoth{p})$ itself. A closed set in $\textrm{Spec}(B)$ is $V(\textgoth{b})$. $f^{*-1}(\textgoth{p})$ are prime ideals of $B$ such that $f^*(\textgoth{q}) = \textgoth{p}$ that is $f^{-1}(\textgoth{q}) = \textgoth{p}$. The intersection are prime ideals $\textgoth{q}$ of $B$ such that $f^{-1}(\textgoth{q}) = \textgoth{p}$ and $\textgoth{q} \supseteq \textgoth{p}$. We have already proved that they do not meet $f(A \setminus \textgoth{p})$, so they are all in $\psi^*(\textrm{Spec}(B_\textgoth{p})$. In $\textrm{Spec}(B_\textgoth{p})$ each of them is mapped to $\textgoth{q}B_\textgoth{p} \supseteq \textgoth{b}B_\textgoth{p}$; it is in $V(\textgoth{b}B_\textgoth{p})$. After surjection onto $B_\textgoth{p}/\textgoth{p}B_\textgoth{p}$, they all fall into $V$ of the surjection of $\textgoth{b}B_\textgoth{p}$
\[
\rho(V(\textgoth{b}B_\textgoth{p})) = V(\rho(\textgoth{b}B_\textgoth{p}))
\]

We move to the final isomorphism $B_\ppp/ \ppp B_\ppp \cong A_\ppp / \ppp A_\ppp$.

The first way is by J. D. Taylor.
\begin{align*}
B/\ppp B_\ppp & \cong A_\ppp/\ppp A_\ppp \otimes_{A_\ppp} B_\ppp \\
              & \cong A_\ppp/\ppp A_\ppp \otimes_{A_\ppp} A_\ppp \otimes_A B \\
              & \cong A_\ppp/\ppp A_\ppp \otimes_A B
\end{align*}
The first isomorphism is an application of Exercise 2.2:i9i
\[
A/\aaa \otimes_A M \cong M/\aaa M
\]
to $M \coloneqq B_\ppp, A \coloneqq A_\ppp, \aaa \coloneqq \ppp A_\ppp $, then application of 
$(\ppp A_\ppp)B_\ppp = \ppp B_\ppp$.

\noindent
The second isomprphism is an application of Proposition 3.5:
\begin{align*} 
S^{-1}A \otimes_A M & \cong S^{-1}M \\
A_\ppp \otimes_A M & \cong M_\ppp \\
A_\ppp \otimes_A B & \cong B_\ppp
\end{align*} 

The second way is inspired by P. Y. Gaillard.
We take take the exact sequence
\[
0 \rightarrow \ppp A_\ppp \rightarrow A_\ppp \rightarrow A_\ppp/\ppp A_\ppp \rightarrow 0
\]
Then tensor it with $M$ over $A$. The sequence
\[
\ppp A_\ppp \otimes_A M \rightarrow A_\ppp \otimes_A M \rightarrow A_\ppp / \ppp A_\ppp \otimes_A M \rightarrow 0
\]
is exact. This sequence on elements
\begin{alignat*}{2}
\frac{a}{s} \otimes m 
  & \mapsto  
  & \frac{a}{s} \otimes m 
  & \mapsto 
    \left[ \frac{a}{s} \right] \otimes m \\
&& \frac{a}{s} \otimes m  
  & \mapsto 
    \left[ \frac{a}{s} \right] \otimes m
\end{alignat*}
To its second module, we apply Proposition 3.5
\begin{align*}
A_\ppp \otimes_A M & \cong M_\ppp \\
\frac{a}{s} \otimes m & \mapsto \frac{am}{s} \\
\frac{1}{s} \otimes m & \mapsfrom \frac{m}{s}
\end{align*}
getting the third exact sequence
\[
\ppp A_\ppp \otimes_A M \rightarrow M_\ppp \rightarrow A_\ppp / \ppp A_\ppp \otimes_A M \rightarrow 0
\]
The first homomorphism of this sequence is
\[
\ppp A_\ppp \otimes_A M \rightarrow A_\ppp \otimes_A M \rightarrow M_\ppp
\]
\[
\frac{a}{s}\otimes m \mapsto \frac{a}{s}\otimes m \mapsto \frac{am}{s} 
\]
The second isomorphism is
\[
M_\ppp \rightarrow A_\ppp \otimes_A M \rightarrow A_\ppp/\ppp A_\ppp \otimes_A M
\]
\[
\frac{m}{s} \mapsto \frac{1}{s} \otimes m \mapsto \left[ \frac{1}{s} \right] \otimes m
\]
What is the image of $\ppp A_\ppp \otimes_A M$ in $M\_ppp$ in the third sequence? It is
\[
\Bigl\{ \frac{am}{s}: a \in \ppp, s \notin \ppp  \Bigr\} = \ppp M_\ppp
\]
Now we can state that
\[
M_\ppp/\ppp M_\ppp \cong A_\ppp/\ppp A_\ppp \otimes_A M
\]
\[
\frac{m}{s} = \ppp M_\ppp \mapsto \left(\frac{1}{s} + \ppp A_\ppp \right) \otimes m
\]
What is the inverse? The general element of $A_\ppp/\ppp A_\ppp \otimes_A M$ 
\[
\left( \frac{a}{s} + \ppp A_\ppp \right) \otimes m = a \left( \frac{1}{s} + \ppp A_\ppp \right) \otimes m = \left( \frac{1}{s} + \ppp A_\ppp \right) \otimes am
\]
is the image of
\[
\frac{am}{s} + \ppp M_\ppp
\]
The corresponding element in $M_\ppp/\ppp M_\ppp$ is its preimage. The inverse map on elements is
\[
\left( \frac{a}{s} + \ppp A_\ppp \right) \otimes m \mapsto \frac{am}{s} + \ppp M_\ppp
\]
\end{document}

